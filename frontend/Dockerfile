FROM node@sha256:557e52a0fcb928ee113df7e1fb5d4f60c1341dbda53f55e3d815ca10807efdce
 
WORKDIR /app

ARG REACT_APP_API_KEY
ARG REACT_APP_BACKEND_URL
ARG REACT_APP_WEBSOCKET_URL
ENV REACT_APP_API_KEY=$REACT_APP_API_KEY
ENV REACT_APP_BACKEND_URL=$REACT_APP_BACKEND_URL
ENV REACT_APP_WEBSOCKET_URL=$REACT_APP_WEBSOCKET_URL

COPY package*.json ./
 
RUN yarn install
 
COPY . .
 
EXPOSE 3000
 
RUN REACT_APP_API_KEY=$REACT_APP_API_KEY \
    REACT_APP_BACKEND_URL=$REACT_APP_BACKEND_URL \
    REACT_APP_WEBSOCKET_URL=$REACT_APP_WEBSOCKET_URL \
    yarn build
RUN yarn global add serve
CMD ["serve", "-s", "build", "-l", "3000"]